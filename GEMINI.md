# 任務目標

根據 `README.md` 的描述，我的任務是撰寫一個 Python 腳本，用來自動化更新 `Files/_updates.txt` 這個檔案。

此腳本的目的是簡化版本更新資訊的維護作業，確保 `_updates.txt` 準確反映 `Files/` 目錄下的檔案狀態。

## 腳本執行步驟規劃

**Python 腳本名稱：** upd_file_versions.py

我將按照以下步驟來設計這個 Python 腳本：

1.  **刪除多餘檔案 (.pdb)**：
    *   腳本會掃描 `Files/` 目錄，找出所有副檔名為 `.pdb` 的檔案。
    *   將這些 `.pdb` 檔案從 `Files/` 目錄中刪除。
    *   在刪除時，會在螢幕上顯示如：`刪除多餘檔案: Txt2Brl.pdb`。

2.  **讀取目標目錄**：
    *   腳本會掃描 `Files/` 目錄下的所有檔案。
    *   會自動忽略 `_updates.txt` 本身，避免將其加入清單。

3.  **蒐集檔案資訊並提供回饋**：
    *   建立一個清單來存放每個檔案的資訊（檔名和版本）。
    *   逐一檢查 `Files/` 目錄中的每個檔案，並在螢幕上顯示處理進度：
        *   **對於 `.exe` 和 `.dll` 檔案**：使用 Python 的 `pefile` 或 `win32api` 等相關函式庫來讀取檔案內嵌的版本資訊。
            *   如果成功讀取，就記錄「檔名」與「版本號」，並在螢幕上顯示如：`更新 Txt2Brl.exe (版本: 5.0.0.0)`。
            *   如果讀取失敗，則記錄「檔名」與「?」，並顯示如：`無法讀取 Txt2Brl.exe 版本，將標示為 ?`。
        *   **對於其他類型檔案**：直接記錄「檔名」與「?」，並在螢幕上顯示如：`加入 AppConfig.ini`。

4.  **移除不存在的檔案紀錄**：
    *   腳本會以 `Files/` 目錄下實際存在的檔案清單為準。舊的 `_updates.txt` 內容將被完全覆蓋，因此不存在的檔案紀錄會自動被移除。

5.  **排序**：
    *   在產生新的 `_updates.txt` 內容之前，會根據「檔名」對蒐集到的清單進行字母排序。

6.  **格式化輸出**：
    *   為了讓分號「;」對齊，腳本會先找出所有檔名中最長的長度。
    *   接著，以這個最大長度為基準，在每個較短的檔名後面補上適當數量的空白字元。
    *   最後，將格式化後的內容寫入 `Files/_updates.txt`，覆蓋掉舊的內容。

完成後，這個 Python 腳本將可以重複執行，以確保 `_updates.txt` 的內容始終保持最新且格式整齊。
